# configuration.yaml — KORRIGIERT
# Packages-Zeile auskommentiert, da Ordner gelöscht wurde

homeassistant:
  name: Zuhause
  latitude: 49.91
  longitude: 9.08
  elevation: 150
  unit_system: metric
  time_zone: Europe/Berlin
  external_url: "https://100.86.240.112:8123"
  internal_url: "https://192.168.178.71:8123"
  # packages: !include_dir_named packages   # ← AUSKOMMENTIERT - Ordner existiert nicht mehr

# Standard-Includes
automation: !include automations.yaml
script: !include scripts.yaml
scene: !include scenes.yaml

# ZHA Configuration
zha:
  enable_quirks: true
  custom_quirks_path: /config/custom_zha_quirks

# Logger Configuration
logger:
  default: warning
  logs:
    homeassistant.components.zha: warning
    zhaquirks: warning
    zigpy: warning

# Recorder Optimization - keeps DB small & fast
recorder:
  purge_keep_days: 7
  commit_interval: 1
  auto_purge: true
  auto_repack: true
  exclude:
    domains:
      - automation
      - updater
      - camera
    entity_globs:
      - sensor.*_rssi
      - sensor.*_lqi
      - sensor.*_linkquality
    entities:
      - sun.sun
      - sensor.time
      - sensor.date

# Energy Dashboard
energy:

default_config:
bluetooth:

# DuckDNS SSL Configuration
http:
  ssl_certificate: /ssl/fullchain.pem
  ssl_key: /ssl/privkey.pem

# ============================================================================
# INPUT NUMBER HELPER - Cover Position Tracking
# ============================================================================
input_number:
  pos_computer:
    name: "Rollladen Computer Position"
    min: 0
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: box
    icon: mdi:window-shutter

  pos_kuche:
    name: "Rollladen Küche Position"
    min: 0
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: box
    icon: mdi:window-shutter

  pos_yoga:
    name: "Rollladen Yoga Position"
    min: 0
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: box
    icon: mdi:window-shutter

  pos_schlafen:
    name: "Rollladen Schlafzimmer Position"
    min: 0
    max: 100
    step: 1
    unit_of_measurement: "%"
    mode: box
    icon: mdi:window-shutter

  # HEIZUNGSSTEUERUNG - Temperatur-Sollwerte
  heizung_solltemperatur_komfort:
    name: "Heizung Komfort-Temperatur"
    min: 18
    max: 24
    step: 0.5
    initial: 21
    unit_of_measurement: "°C"
    mode: slider
    icon: mdi:thermometer

  heizung_solltemperatur_eco:
    name: "Heizung Eco-Temperatur"
    min: 16
    max: 20
    step: 0.5
    initial: 18
    unit_of_measurement: "°C"
    mode: slider
    icon: mdi:thermometer-low

  heizung_solltemperatur_nacht:
    name: "Heizung Nacht-Temperatur"
    min: 15
    max: 19
    step: 0.5
    initial: 17
    unit_of_measurement: "°C"
    mode: slider
    icon: mdi:thermometer-low

# ============================================================================
# INPUT BOOLEAN HELPER - Heizungsmodi
# ============================================================================
input_boolean:
  heizung_eco_mode:
    name: "Heizung Eco-Modus"
    icon: mdi:leaf

  heizung_winter_mode:
    name: "Heizung Winter-Modus (Rollläden-Optimierung)"
    icon: mdi:snowflake

# ============================================================================
# BINARY SENSOR - Sommerbetrieb automatisch erkennen
# ============================================================================
binary_sensor:
  - platform: template
    sensors:
      sommerbetrieb_ortsbasiert:
        friendly_name: "Sommerbetrieb (Außentemperatur)"
        value_template: >-
          {{ states('sensor.openweathermap_temperature')|float(0) > 18 }}
        icon_template: >-
          {% if states('sensor.openweathermap_temperature')|float(0) > 18 %}
            mdi:weather-sunny
          {% else %}
            mdi:snowflake
          {% endif %}
